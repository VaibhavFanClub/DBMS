----------------------------------- Q2 --------------------------------------------

assignment1=# create table area(aname varchar(20) primary key, atype varchar(5) check(atype in('rural','urban')));
CREATE TABLE
assignment1=# create table person(pno int primary key, pname varchar(20), bdate date, income money, aname varchar(20) references area);
CREATE TABLE
assignment1=# insert into area values('Pune','urban'),('Moshi','rural'),('Bhosari','rural'),('Viman Nagar','urban');
INSERT 0 4
assignment1=# insert into person values(1,'Avishkar','15-Apr-2005',30000,'Pune');
INSERT 0 1
assignment1=# insert into person values(2,'Om','25-Sep-2005',25000,'Bhosari'),(3,'Ashish','6-Sep-2004',20000,'Moshi'),(4,'Rohan','25-Mar-2005',27000,'Pune'),(5,'Summit','4-Jul-2005',18000,'Viman Nagar'),(6,'Tushar','12-Apr-2003',15000,'Moshi');
INSERT 0 5
assignment1=# select * from area;
    aname    | atype 
-------------+-------
 Pune        | urban
 Moshi       | rural
 Bhosari     | rural
 Viman Nagar | urban
(4 rows)

assignment1=# select * from person;
 pno |  pname   |   bdate    |   income   |    aname    
-----+----------+------------+------------+-------------
   1 | Avishkar | 2005-04-15 | ₹30,000.00 | Pune
   2 | Om       | 2005-09-25 | ₹25,000.00 | Bhosari
   3 | Ashish   | 2004-09-06 | ₹20,000.00 | Moshi
   4 | Rohan    | 2005-03-25 | ₹27,000.00 | Pune
   5 | Summit   | 2005-07-04 | ₹18,000.00 | Viman Nagar
   6 | Tushar   | 2003-04-12 | ₹15,000.00 | Moshi
(6 rows)

assignment1=# select pname from person,area where person.aname = area.aname and area.aname = 'Pune';
  pname   
----------
 Avishkar
 Rohan
(2 rows)

assignment1=# select pname from person where pname like 'A%';
  pname   
----------
 Avishkar
 Ashish
(2 rows)

assignment1=# select area.aname, count(pno) from area, person where area.aname = person.aname and income > 10000 group by area.aname;
ERROR:  operator does not exist: money > integer
LINE 1: ...person where area.aname = person.aname and income > 10000 gr...
                                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
assignment1=# select area.aname, count(pno) from area, person where area.aname = person.aname and income::numeric::int > 10000 group by area.aname;
    aname    | count 
-------------+-------
 Viman Nagar |     1
 Pune        |     2
 Moshi       |     2
 Bhosari     |     1
(4 rows)

assignment1=# select pname from person where income between 5000 and 20000;
ERROR:  operator does not exist: money >= integer
LINE 1: select pname from person where income between 5000 and 20000...
                                              ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
assignment1=# select pname from person where income::numeric::int between 5000 and 20000;
 pname  
--------
 Ashish
 Summit
 Tushar
(3 rows)

assignment1=# select pname from person where to_char('bdate','month') = 'Apr';
ERROR:  function to_char(unknown, unknown) is not unique
LINE 1: select pname from person where to_char('bdate','month') = 'A...
                                       ^
HINT:  Could not choose a best candidate function. You might need to add explicit type casts.
assignment1=# select pname from person where income in(select income from person);
  pname   
----------
 Tushar
 Summit
 Ashish
 Om
 Rohan
 Avishkar
(6 rows)

assignment1=# select pname from person where to_char('bdate','month') = '04';
ERROR:  function to_char(unknown, unknown) is not unique
LINE 1: select pname from person where to_char('bdate','month') = '0...
                                       ^
HINT:  Could not choose a best candidate function. You might need to add explicit type casts.
assignment1=# select pname from person where extract(month from bdate) = '04';
  pname   
----------
 Avishkar
 Tushar
(2 rows)

assignment1=# select aname,max(income) from area, person where area.aname = person.aname group by aname;
ERROR:  column reference "aname" is ambiguous
LINE 1: select aname,max(income) from area, person where area.aname ...
               ^
assignment1=# select area.aname,max(income) from area, person where area.aname = person.aname group by area.aname;
    aname    |    max     
-------------+------------
 Moshi       | ₹20,000.00
 Pune        | ₹30,000.00
 Viman Nagar | ₹18,000.00
 Bhosari     | ₹25,000.00
(4 rows)

assignment1=# update person set income = income + (income * 0.1) where aname in(select aname from area where atype = 'rural');
UPDATE 3
assignment1=# select * from person;
 pno |  pname   |   bdate    |   income   |    aname    
-----+----------+------------+------------+-------------
   1 | Avishkar | 2005-04-15 | ₹30,000.00 | Pune
   4 | Rohan    | 2005-03-25 | ₹27,000.00 | Pune
   5 | Summit   | 2005-07-04 | ₹18,000.00 | Viman Nagar
   2 | Om       | 2005-09-25 | ₹27,500.00 | Bhosari
   3 | Ashish   | 2004-09-06 | ₹22,000.00 | Moshi
   6 | Tushar   | 2003-04-12 | ₹16,500.00 | Moshi
(6 rows)

assignment1=# select * from person order by pname desc;
 pno |  pname   |   bdate    |   income   |    aname    
-----+----------+------------+------------+-------------
   6 | Tushar   | 2003-04-12 | ₹16,500.00 | Moshi
   5 | Summit   | 2005-07-04 | ₹18,000.00 | Viman Nagar
   4 | Rohan    | 2005-03-25 | ₹27,000.00 | Pune
   2 | Om       | 2005-09-25 | ₹27,500.00 | Bhosari
   1 | Avishkar | 2005-04-15 | ₹30,000.00 | Pune
   3 | Ashish   | 2004-09-06 | ₹22,000.00 | Moshi
(6 rows)




---------------------------------------- set a 3 ---------------------------------------

assignment1=# create table book(b_no int primary key, b_name varchar(20), pub_name varchar(10), b_price float);
CREATE TABLE
assignment1=# create table author(a_no int primary key, a_name varchar(20), qualification varchar(15), address varchar(15));
CREATE TABLE
assignment1=# create table b_a(id int primary key, b_no int references book, a_no int references author);
CREATE TABLE
assignment1=# insert into book values(1, 'Science', 'Nirali', 540),(2, 'IT', 'Nirali', 450),(3, 'Buissnes Managment', 'Balbharti', 300),(4, 'ABC', 'Niyati Pub', 250),(5, 'Science and tech', 'Nirali', 590);
INSERT 0 5
assignment1=# insert into author values(10, 'Sushant', 'phD', 'Pune'),(11, 'Rohan', 'MCOM', 'Nagar'),(12, 'Vikas', 'MBA', 'Nashik'),(13, 'Shantanu', 'BTech', 'Pune'),(14, 'Rajesh', 'BCA', 'Nashik');
INSERT 0 5
assignment1=# insert into b_a values(111, 1, 13),(112, 1, 10),(113, 2, 14),(114, 3, 11),(115, 3, 12),(116, 4, 14),(117, 5, 10),(118, 5, 13);
assignment1=# select * from book;
 b_no |       b_name       |  pub_name  | b_price 
------+--------------------+------------+---------
    1 | Science            | Nirali     |     540
    2 | IT                 | Nirali     |     450
    3 | Buissnes Managment | Balbharti  |     300
    5 | Science and tech   | Nirali     |     590
    4 | ABC                | Niyati Pub |     250
(5 rows)

assignment1=# select * from author;
 a_no |  a_name  | qualification | address 
------+----------+---------------+---------
   10 | Sushant  | phD           | Pune
   11 | Rohan    | MCOM          | Nagar
   13 | Shantanu | BTech         | Pune
   12 | Vikas    | MBA           | Nashik
   14 | Rajesh   | BCA           | Nashik
(5 rows)

assignment1=# select * from b_a;
 id  | b_no | a_no 
-----+------+------
 111 |    1 |   13
 112 |    1 |   10
 113 |    2 |   14
 114 |    3 |   11
 115 |    3 |   12
 116 |    4 |   14
 117 |    5 |   10
 118 |    5 |   13
(8 rows)

assignment1=# select * from book where b_no in(select b_no from b_a where a_no in(select a_no from author where a_name = 'Shantanu'));
 b_no |      b_name      | pub_name | b_price 
------+------------------+----------+---------
    1 | Science          | Nirali   |     540
    5 | Science and tech | Nirali   |     590
(2 rows)

assignment1=# select count(*) from book where pub_name = 'Nirali';
 count 
-------
     3
(1 row)

assignment1=# select * from book where b_price between 400 and 600;
 b_no |      b_name      | pub_name | b_price 
------+------------------+----------+---------
    1 | Science          | Nirali   |     540
    2 | IT               | Nirali   |     450
    5 | Science and tech | Nirali   |     590
(3 rows)

assignment1=# select * from author order by a_name;
 a_no |  a_name  | qualification | address 
------+----------+---------------+---------
   14 | Rajesh   | BCA           | Nashik
   11 | Rohan    | MCOM          | Nagar
   13 | Shantanu | BTech         | Pune
   10 | Sushant  | phD           | Pune
   12 | Vikas    | MBA           | Nashik
(5 rows)

assignment1=# update book set pub_name = 'JagrutiPub' where pub_name = 'Niyati Pub';
UPDATE 1

assignment1=# select * from book where b_name like 'S%';
 b_no |      b_name      | pub_name | b_price 
------+------------------+----------+---------
    1 | Science          | Nirali   |     540
    5 | Science and tech | Nirali   |     590
(2 rows)

assignment1=# select a_name, book.b_no, b_name, pub_name, b_price from author, book, b_a where author.a_no = b_a.a_no and book.b_no = b_a.b_no order by a_name;
  a_name  | b_no |       b_name       |  pub_name  | b_price 
----------+------+--------------------+------------+---------
 Rajesh   |    4 | ABC                | JagrutiPub |     250
 Rajesh   |    2 | IT                 | Nirali     |     450
 Rohan    |    3 | Buissnes Managment | Balbharti  |     300
 Shantanu |    1 | Science            | Nirali     |     540
 Shantanu |    5 | Science and tech   | Nirali     |     590
 Sushant  |    1 | Science            | Nirali     |     540
 Sushant  |    5 | Science and tech   | Nirali     |     590
 Vikas    |    3 | Buissnes Managment | Balbharti  |     300
(8 rows)

assignment1=# select * from author where a_no in(select a_no from b_a group by a_no having count(*) >= 2);
 a_no |  a_name  | qualification | address 
------+----------+---------------+---------
   10 | Sushant  | phD           | Pune
   13 | Shantanu | BTech         | Pune
   14 | Rajesh   | BCA           | Nashik
(3 rows)

assignment1=# select * from book where b_no in(select b_no from b_a where a_no in(select a_no from author where address = 'Nashik'));
 b_no |       b_name       |  pub_name  | b_price 
------+--------------------+------------+---------
    4 | ABC                | JagrutiPub |     250
    2 | IT                 | Nirali     |     450
    3 | Buissnes Managment | Balbharti  |     300
(3 rows)

assignment1=# SELECT a.a_no, a.a_name, COUNT(b.b_no) AS book_count
FROM author a
JOIN b_a ba ON a.a_no = ba.a_no
JOIN book b ON ba.b_no = b.b_no
GROUP BY a.a_no, a.a_name
HAVING COUNT(b.b_no) = (
    SELECT MAX(book_count)
    FROM (
        SELECT a.a_no, COUNT(b.b_no) AS book_count
        FROM author a
        JOIN b_a ba ON a.a_no = ba.a_no
        JOIN book b ON ba.b_no = b.b_no
        GROUP BY a.a_no
    ) AS author_book_counts
);
 a_no |  a_name  | book_count 
------+----------+------------
   10 | Sushant  |          2
   14 | Rajesh   |          2
   13 | Shantanu |          2
(3 rows)




-------------------------------------- set B 1 ------------------------------------------

assignment1=# create table actor(a_name varchar(20) primary key, role char(20), charges money, a_address varchar(20));
CREATE TABLE
assignment1=# create table movie(m_name varchar(25) primary key, release_year int, budget money);
CREATE TABLE
assignment1=# create table producer(pid int primary key, p_name char(30), p_address varchar(20));
CREATE TABLE
assignment1=# create table m_p(m_name varchar(25) references movie, pid int references producer);
CREATE TABLE
assignment1=# create table m_a(m_name varchar(25) references movie, a_name varchar(20) references actor);
CREATE TABLE



